/* ==========================================================================
   Capital Framework
   Form Element Styling
   ========================================================================== */
//
// Theme variables
//

// Color variables

// .error
@input-error:                   @red;

// warning
@input-warning:                 @gold;

// .success
@input-success:                 @green;

// .disabled
@input-disabled:                @gray-10;
@input-disabled-text:           @gray-80;

// select
@select-border:                 @gray-40;
@select-icon:                   @gray-80;

// Large target area variables
@input-big-target-bg:           #d6d7d9; // $color-gray-lighter

@input-big-target-bg__selected: #9bdaf1; // $color-primary-alt-light
@input-border__selected:        #046b99; // $color-primary-alt-darkest

@input-big-target-bg__disabled: #aeb0b5; // $color-gray-light

// Sizing variables

// .input__super
@input__super-font-size:        18px;


// Import external dependencies

@import (less) '../../cf-grid/src/cf-grid.less';
@import (less) '../../cf-core/src/cf-core.less';
@import (less) '../../cf-buttons/src/cf-buttons.less';
@import (less) '../../cf-icons/src/cf-icons.less';


//
// Import molecules and atoms
//

@import (less) 'molecules/big-checkboxes.less';
@import (less) 'molecules/big-radio-buttons.less';
@import (less) 'organisms/form-input-group.less';

//
// Form labels
//

label {
    display: block;
    // 5px is eyeballed to 10px when considering line height.
    margin-bottom: unit( 5px / @base-font-size-px, em );
}

.form-label-header {
    .heading-5();
    margin-bottom: unit(10px / @font-size, em );
}

//
// Form elements
//

input[type="text"],
input[type="search"],
input[type="email"],
input[type="url"],
input[type="tel"],
input[type="number"],
textarea,
select[multiple] {
    @font-size: 16px;
    .u-webfont-regular();

    display: inline-block;
    padding: unit( 6px / @base-font-size-px, em );
    border: 1px solid @input-border;
    border-radius: 0;
    margin: 0;
    background: @input-bg;
    font-size: unit( @font-size / @base-font-size-px, em );
    vertical-align: top;
    appearance: none;

    &.warning {
        border: 1px solid @input-warning;
        outline: 1px solid @input-warning;
    }
}

.warning + .@{cf-forms_input-icon-class} {
    color: @input-warning;
}

// Overrides extra left padding.
// http://stackoverflow.com/questions/11127891/how-can-i-get-rid-of-horizontal-padding-or-indent-in-html5-search-inputs-in-webk
::-webkit-search-decoration {
    appearance: none;
}

// The .focus class is only included for documentation demos and should not
// be used in production.
input[type="text"]:focus,
input[type="text"].focus,
input[type="search"]:focus,
input[type="search"].focus,
input[type="email"]:focus,
input[type="email"].focus,
input[type="url"]:focus,
input[type="url"].focus,
input[type="tel"]:focus,
input[type="tel"].focus,
input[type="number"]:focus,
input[type="number"].focus,
textarea:focus,
textarea.focus,
select[multiple]:focus,
select[multiple].focus {
    border: 1px solid @input-border-focus;
    outline: 1px solid @input-border-focus;
    outline-offset: 0;
    box-shadow: none;
}

::-webkit-input-placeholder {
    color: @input-placeholder;
}
::-moz-placeholder {
    color: @input-placeholder;
}
:-ms-input-placeholder {
    color: @input-placeholder;
}

input[type="radio"],
input[type="checkbox"] {
    margin-top: unit( 4px / @base-font-size-px, em );
    margin-right: unit( 7px / @base-font-size-px, em );
    float: left;
}

//
// Super input
//

.input__super {
    &[type="text"],
    &[type="search"],
    &[type="email"],
    &[type="url"],
    &[type="tel"],
    &[type="number"] {
        padding: unit( 10px / @input__super-font-size, em );
        font-size: unit( @input__super-font-size / @base-font-size-px, em );
    }
}

//
// Input states
//

input[type="text"],
input[type="search"],
input[type="email"],
input[type="url"],
input[type="tel"],
input[type="number"],
select[multiple],
textarea {
    &.error {
        border: 1px solid @input-error;
        outline: 1px solid @input-error;
    }
    &.warning {
        border: 1px solid @input-warning;
        outline: 1px solid @input-warning;
    }
    &.success {
        border: 1px solid @input-success;
        outline: 1px solid @input-success;
    }
    &.disabled {
        background-color: @input-disabled;
    }
}

//
// Form icons
//

@cf-forms_input-icon-class: cf-form_input-icon;

.@{cf-forms_input-icon-class} {
    @font-size: 20px;

    position: relative;
    top: unit(6px / @font-size, em );
    margin-left: unit(4px / @font-size, em );
    font-size: unit(@font-size / @base-font-size-px, em );
}

.error + .@{cf-forms_input-icon-class} {
    color: @input-error;
}

.warning + .@{cf-forms_input-icon-class} {
    color: @input-warning;
}

.success + .@{cf-forms_input-icon-class} {
    color: @input-success;
}

//
// Input with button
//

.input-with-btn {

    .respond-to-min( 480px, {
        .grid_nested-col-group();
    });

    &_input {
        margin-bottom: unit( 15px / @base-font-size-px, em );
        .respond-to-min( 480px, {
            .grid_column(9);
            border-right-width: 0;
        });
        .respond-to-min( 960px, {
            .grid_column(10);
            border-right-width: 0;
        });

        input {
            box-sizing: border-box;
            width: 100%;
        }
    }

    &_btn {
        margin-bottom: unit( 15px / @base-font-size-px, em );

        .respond-to-min( 480px, {
            .grid_column(3);
        });
        .respond-to-min( 960px, {
            .grid_column(2);
        });

        .btn {
            box-sizing: border-box;
            width: 100%;
        }

        .btn__super {
            padding-left: unit( 15px / @super-btn-font-size, em );
            padding-right: unit( 15px / @super-btn-font-size, em );
        }
    }

}

//
// Button inside input
//

.btn-inside-input {

    position: relative;

    input[type="text"],
    input[type="search"],
    input[type="email"],
    input[type="url"],
    input[type="tel"],
    input[type="number"] {
        box-sizing: border-box;
        width: 100%;
        padding-right: unit(65px / @btn-font-size, em );

        &.input__super {
            padding-right: unit(90px / @super-btn-font-size, em );
        }
    }

    .btn {
        .u-link__no-border();
        position: absolute;
        right: unit( 15px / @btn-font-size, em );
        top: 0;

        &__super {
            right: unit( 15px / @super-btn-font-size, em );
        }

        /* pa11y fails unless the background color is explicitly set */
        &__link.btn__secondary {
            background-color: #fff;
        }
    }

}


//
// Form layouts
//

.form-l {
    &__flush {
        .respond-to-min( @bp-lg-min, {
            .grid_nested-col-group();
        });
    }

    &__float {
        .respond-to-min( @bp-lg-min, {
            .u-clearfix();
            & .form-l_col {
                display: block;
                float: left;
                margin-right: 0;
            }
        });
    }

    .respond-to-min( @bp-sm-min, {
        .grid_nested-col-group();
    });
}

.form-l_col {
    margin-bottom: unit(@grid_gutter-width / @base-font-size-px, em );

    &__flush-bottom {
        // Used when a col is wrapping inner cols that
        // have their own margin
        margin-bottom: 0;
    }

    input[type="text"],
    input[type="search"],
    input[type="email"],
    input[type="url"],
    input[type="tel"],
    input[type="number"],
    select,
    textarea {
        // TODO: Move border-box value to cf-forms.
        box-sizing: border-box;
        width: 100%;
    }
}

.respond-to-min( @bp-sm-min, {
    .form-l_col-1-4 {
        .grid_column(3);
    }

    .form-l_col-1-2 {
        .grid_column(6);
    }

    .form-l_col-1-3 {
        .grid_column(4);
    }

    .form-l_col-2-3 {
        .grid_column(8);
    }

    .form-l_col-1 {
        .grid_column(12);
    }
});

//
// m-select menu
//

.m-select {
    position: relative;
    margin-top: 0.5em;
    border: 1px solid @select-border;

    select {
        height: unit( 30px / @base-font-size-px, em );
        width: 100%;
        padding: unit( 4px / @base-font-size-px, em )
                 unit( 6px / @base-font-size-px, em );
        border: 0;
        outline: 2px solid transparent;
        appearance: none;
        background-color: @input-bg;
        border-radius: 0;
        color: @text;

        &:hover,
        &:active,
        &:focus {
            outline-color: @input-border-focus;
            outline-offset: 0;
        }
    }

    select[disabled] {
        color: @input-disabled-text;
        background-color: @input-disabled;
        cursor: not-allowed;

        &:hover {
            outline: 2px solid transparent;
        }
    }

    select option:disabled {
        color: @input-disabled;
    }

    &:after {
        width: unit( 30px / @base-font-size-px, em );
        height: unit( 30px / @base-font-size-px, em );
        border-left: 1px solid @select-border;
        position: absolute;
        top: 0;
        right: 0;
        background-color: @input-disabled;
        color: @select-icon;
        content: @cf-icon-down;
        font-family: 'CFPB Minicons';
        line-height: unit( 30px / @base-font-size-px, em );
        text-align: center;
        pointer-events: none;
    }
}

// @todo: add modernizr to CF so this works:

.no-csspointerevents .m-select {
    &:after {
        height: 0;
        width: 0;
        border: 0;
        content: '';
    }
}
